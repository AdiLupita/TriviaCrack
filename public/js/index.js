"use strict";function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(e){_defineProperty(t,e,n[e])})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var API=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"post",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return fetch(e,{method:"POST",rejectUnauthorized:!1,headers:_objectSpread({},n),body:t})}},{key:"patch",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return fetch(e,{method:"PATCH",rejectUnauthorized:!1,headers:_objectSpread({},n),body:t})}},{key:"get",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return fetch(e,{method:"GET",rejectUnauthorized:!1,headers:_objectSpread({},t)})}},{key:"delete",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return fetch(e,{method:"DELETE",rejectUnauthorized:!1,headers:_objectSpread({},n),body:t})}}]),e}(),slideIndex=0,TIME_SLIDE=5e3,length=0;function loadingCarrusel(){showSlides(),pagesEvent()}function pagesEvent(){for(var t=document.getElementsByClassName("owl-page"),e=function(e){t[e].addEventListener("click",function(){changePages(e)})},n=0;n<t.length;n+=1)e(n)}function changePages(e){slideIndex=e;var t=document.getElementsByClassName("owl-page"),n=document.getElementsByClassName("slides");(length=t.length)>n.length&&(length=n.length);for(var a=0;a<length;a+=1)a===e?(t[a].classList.add("active"),n[a].classList.add("visible")):(t[a].classList.remove("active"),n[a].classList.remove("visible"))}function showSlides(){changePages(slideIndex),length-1<++slideIndex&&(slideIndex=0),setTimeout(showSlides,TIME_SLIDE)}function loadingMenuAdmin(){try{document.getElementById("hide-filter").addEventListener("click",hideMenu)}catch(e){}}function hideMenu(){try{var e=document.getElementById("filter"),t=document.getElementById("content");e.classList.toggle("hide-item"),t.classList.toggle("col-9"),t.classList.toggle("col-12")}catch(e){}}window.addEventListener("load",loadingCarrusel),window.addEventListener("load",loadingMenuAdmin),window.addEventListener("load",loadingPagination);var route="";function loadingPagination(){try{var e=document.getElementById("title");"Questions"==e.firstChild.textContent?route="questions":"Games"==e.firstChild.textContent?route="games":"Users"==e.firstChild.textContent&&(route="users")}catch(e){}try{document.getElementById("before").addEventListener("click",beforePage),document.getElementById("next").addEventListener("click",nextPage);var t=document.getElementById("pagination").getElementsByTagName("button"),n=!0,a=!1,i=void 0;try{for(var d,l=t[Symbol.iterator]();!(n=(d=l.next()).done);n=!0){var o=d.value;t[0]!==o&&t[t.length-1]!==o&&o.addEventListener("click",changePage)}}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}}catch(e){}}function beforePage(){var e=1;1<this.value&&(e=Number(this.value)-1),location.href="/".concat(route,"?page=").concat(e)}function nextPage(){var e=Number(this.value)+1;location.href="/".concat(route,"?page=").concat(e)}function changePage(){window.location="/".concat(route,"?page=").concat(this.value)}var hideHead,TIME_HIDE_HEADER=3e3;function loadingPrincipal(){try{document.getElementById("drop-menu").addEventListener("click",show),changePictureWelcome()}catch(e){}}function show(){window.clearTimeout(hideHead),document.getElementById("menu").classList.toggle("hide")}function headerScroll(){try{document.getElementById("header").classList.remove("no-visible"),window.clearTimeout(hideHead);var e=document.getElementsByTagName("header"),t=(document.getElementById("logo"),document.getElementById("drop-menu")),n=document.getElementById("menu");window.scrollY<=100?(clearTimeout(hideHead),e[0].classList.remove("scroller"),t.classList.remove("scroller"),n.classList.remove("scroller"),n.parentNode.classList.add("menu"),itemMenuScroll(!1)):(e[0].classList.add("scroller"),t.classList.add("scroller"),n.classList.add("scroller"),n.parentNode.classList.remove("menu"),itemMenuScroll(!0),hideHead=setTimeout(hideHeader,TIME_HIDE_HEADER))}catch(e){}}function hideHeader(){document.getElementById("header").classList.add("no-visible")}function itemMenuScroll(e){var t=document.getElementsByTagName("a"),n=!0,a=!1,i=void 0;try{for(var d,l=t[Symbol.iterator]();!(n=(d=l.next()).done);n=!0){var o=d.value;"menu"===o.parentNode.parentNode.id&&(e?o.classList.add("scroller"):o.classList.remove("scroller"))}}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}}function changePictureWelcome(){var e=document.getElementById("welcome");450<window.screen.width?e.src="img/welcome.png":e.src="img/logo.png"}window.addEventListener("scroll",headerScroll),window.addEventListener("load",loadingPrincipal),window.addEventListener("reload",changePictureWelcome);var MSG_INVAL_NICKNAME="Not valid nickname",MSG_INVAL_PASSWORD="Not valid password",MSG_INVAL_EMAIL="Not valid email format",MSG_INVAL_WORD="Not valid word",MSG_INVAL_TEXT="Not valid text",MSG_INVAL_FILE="Not valid file extension",MSG_INVAL_ID="Not valid id";function invalidInput(e){e.classList.add("incorrect")}function validInput(e){e.classList.remove("incorrect")}function msgErrVal(e,t){document.getElementById(e).classList.add("alert-show"),document.getElementById(e).innerHTML=t}function msgErrValHide(e){document.getElementById(e).classList.remove("alert-show")}var VALITATIONS={id:/^[0-9]+$/,nickname:/^[a-zA-Z][\w]{2,}$/,word:/[a-zA-ZñÑ ]{3,}/,text:/[\wñÑ #@$%?()]{3,}/,password:/^[\wñÑ#@$%]{5,}$/,file:/^[\w]+\.(png|jpg|jpeg)$/,email:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/};function valId(e){return VALITATIONS.id.test(e)}function valNickname(e){return VALITATIONS.nickname.test(e)}function valWord(e){return VALITATIONS.word.test(e)}function valText(e){return VALITATIONS.text.test(e)}function valPassword(e){return VALITATIONS.password.test(e)}function valFile(e){return VALITATIONS.file.test(e)}function valEmail(e){return VALITATIONS.email.test(e)}function apiAddEmail(e){var t=new URLSearchParams({email:e}).toString();API.post("/profile/add_emails",t,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){e.json().then(function(e){if(200===e.statusCode){var t=document.createElement("div");t.innerHTML=e.body;var n=t.children[0],a=n.getElementsByClassName("btn-icon")[0];document.getElementById("list-emails").appendChild(n),a.addEventListener("click",validateRemoveEmailForms),document.getElementById("inp-add-email").value=""}else msgErrVal("msg-alert-email",e.body.error),invalidInput(document.getElementById("inp-add-email"))})})}function validateAddEmailData(){var e=document.getElementById("inp-add-email"),t=!0,n="";valEmail(e.value)?validInput(e):(invalidInput(e),t=!1,n=MSG_INVAL_EMAIL),t?(apiAddEmail(e.value),msgErrValHide("msg-alert-email")):msgErrVal("msg-alert-email",n)}function validateAddEmailForm(){try{document.getElementById("btn-add-email").addEventListener("click",validateAddEmailData)}catch(e){}}function loadAddEmailPage(){console.log("click",this.value),window.location="/profile/add_emails?page=".concat(this.value)}function pagAddEmailForm(){try{for(var e=document.getElementById("pag-emails").getElementsByTagName("button"),t=0;t<e.length;t++)e[t].addEventListener("click",loadAddEmailPage)}catch(e){}}function apiRemoveEmail(){var t=this.parentNode,n=t.parentNode,e={email:t.children[0].value},a=new URLSearchParams(e).toString();API.delete("/profile/add_emails",a,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){204===e.status?n.removeChild(t):msgErrVal("msg-alert-email","Something unexpected happened")})}function validateRemoveEmailForms(){try{for(var e=document.getElementsByName("btn-rm-email"),t=0;t<e.length;t++)e[t].addEventListener("click",apiRemoveEmail)}catch(e){}}function apiAddFriend(e){var t=new URLSearchParams({friend:e}).toString();API.post("/profile/friends",t,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){e.json().then(function(e){if(200===e.statusCode){var t=document.createElement("ul");t.innerHTML=e.body;var n=t.children[0];document.getElementById("list-friends").appendChild(n);var a=n.getElementsByClassName("btn-icon");a[0].addEventListener("click",apiPlay),a[1].addEventListener("click",apiRemoveFriend),document.getElementById("inp-nick-friend").value=""}else msgErrVal("msg-alert-add-friend",e.body.error),invalidInput(document.getElementById("inp-add-email"))})})}function validateAddFriendsData(){var e=document.getElementById("inp-nick-friend"),t=!0,n="";valNickname(e.value)?validInput(e):(invalidInput(e),n=MSG_INVAL_NICKNAME,t=!1),t?(msgErrValHide("msg-alert-add-friend"),apiAddFriend(e.value)):msgErrVal("msg-alert-add-friend",n)}function validateAddFriendsForm(){try{document.getElementById("btn-add-friend").addEventListener("click",validateAddFriendsData)}catch(e){}}function apiRemoveFriend(){var t=this.parentNode.parentNode.parentNode,n=document.getElementById("list-friends"),e={friend:this.value},a=new URLSearchParams(e).toString();API.delete("/profile/friends",a,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){204===e.status?(n.removeChild(t),msgErrValHide("msg-alert-rm-friend")):msgErrVal("msg-alert-rm-friend","Something unexpected happened")})}function apiPlay(){console.log(this.value);var e={player2:this.value},t=new URLSearchParams(e).toString();API.post("/game/select_adversary",t,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){console.log(e),200===e.status?window.location=e.url:e.json().then(function(e){msgErrVal("msg-alert-rm-friend",e.body.error)})})}function validatePlayForm(){try{for(var e=document.getElementsByName("btn-play-friend"),t=document.getElementsByName("btn-rm-friend"),n=0;n<e.length;n++)e[n].addEventListener("click",apiPlay),t[n].addEventListener("click",apiRemoveFriend)}catch(e){}}function apiLogin(e,t){var n=new URLSearchParams({nickname:e,password:t}).toString();API.post("/login",n,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){200===e.status?window.location=e.url:msgErrVal("msg-alert-log","User/password combination is not valid")})}function valInputLogin(){var e=document.getElementById("form-login"),t=e.elements.namedItem("nickname"),n=e.elements.namedItem("password"),a=!0,i=[];valNickname(t.value)?validInput(t):(invalidInput(t),i.push(MSG_INVAL_NICKNAME),a=!1),valPassword(n.value)?validInput(n):(invalidInput(n),i.push(MSG_INVAL_PASSWORD),a=!1),a?(msgErrValHide("msg-alert-log"),apiLogin(t.value,n.value)):msgErrVal("msg-alert-log",i.join(", "))}function validateLoginForm(){try{document.getElementById("btn-login").addEventListener("click",valInputLogin)}catch(e){}}function apiLogout(){API.get("/logout").then(function(e){200===e.status?window.location=e.url:e.json().then(function(e){window.alert(e.body.data.message)})})}function leaveSession(){try{document.getElementById("btn-logout").addEventListener("click",apiLogout)}catch(e){}}function apiEditProfile(e){var t=_objectSpread({},e),n=new URLSearchParams(t).toString();API.patch("/profile/edit",n,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){204===e.status?window.location.reload():e.json().then(function(e){msgErrVal("msg-alert-edit-profile",e.body.error)})})}function validateEditProfileData(){var e=document.getElementById("inp-new-email"),t=document.getElementById("inp-new-pass"),n=document.getElementById("inp-file-avatar"),a=!0,i=[];if(valEmail(e.value)?validInput(e):(invalidInput(e),i.push(MSG_INVAL_EMAIL),a=!1),valPassword(t.value)?validInput(t):(invalidInput(t),i.push(MSG_INVAL_PASSWORD),a=!1),n.files[0]&&(valFile(n.files[0].name)?validInput(n):(invalidInput(n),i.push(MSG_INVAL_FILE),a=!1)),a){var d=!1;msgErrValHide("msg-alert-edit-profile");var l={};e.getAttribute("data-origin-val")!==e.value&&(l.email=e.value,d=!0),t.getAttribute("data-origin-val")!==t.value&&(l.password=t.value,d=!0),d?apiEditProfile(l):msgErrVal("msg-alert-edit-profile","No data modified.")}else msgErrVal("msg-alert-edit-profile",i.join(", "))}function validateEditProfileForm(){try{document.getElementById("btn-edit-profile").addEventListener("click",validateEditProfileData)}catch(e){}}function apiAddQuestion(e,t,n,a,i){var d=new URLSearchParams({category:e,question:t,option1:n,option2:a,optioncorrect:i}).toString();API.post("/question/add",d,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){200===e.status?document.getElementById("form-add-question").reset():e.json().then(function(e){msgErrVal("msg-alert-question",e.body.data)})})}function validateAddQuestionData(){var e=document.getElementById("slc-category"),t=document.getElementById("txt-a-question"),n=document.getElementById("inp-opcion-1"),a=document.getElementById("inp-opcion-2"),i=document.getElementById("inp-opcion-c"),d=!0,l=[];valId(e.value)?validInput(e):(invalidInput(e),d=!1,l.push("Invalid category")),valText(t.value)?validInput(t):(invalidInput(t),d=!1,l.push("".concat(MSG_INVAL_TEXT," in question"))),valText(n.value)?validInput(n):(invalidInput(n),d=!1,l.push("".concat(MSG_INVAL_TEXT," in option 1"))),valText(a.value)?validInput(a):(invalidInput(a),d=!1,l.push("".concat(MSG_INVAL_TEXT," in option 2"))),valText(i.value)?validInput(i):(invalidInput(i),d=!1,l.push("".concat(MSG_INVAL_TEXT," in option correct"))),d?(apiAddQuestion(e.value,t.value,n.value,a.value,i.value),msgErrValHide("msg-alert-question")):msgErrVal("msg-alert-question",l.join(", "))}function validateAddQuestionForm(){try{document.getElementById("btn-add-question").addEventListener("click",validateAddQuestionData)}catch(e){}}function apiRegister(e,t,n){var a=new URLSearchParams({nickname:e,password:n,email:t}).toString();API.post("/register",a,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){200===e.status?window.location=e.url:e.json().then(function(e){msgErrVal("msg-alert-reg","This user/email already exist.")})})}function validateRegData(){var e=document.getElementById("new-nickname"),t=document.getElementById("new-email"),n=document.getElementById("new-password"),a=!0,i=[];valNickname(e.value)?validInput(e):(invalidInput(e),a=!1,i.push(MSG_INVAL_NICKNAME)),valEmail(t.value)?validInput(t):(invalidInput(t),a=!1,i.push(MSG_INVAL_EMAIL)),valPassword(n.value)?validInput(n):(invalidInput(n),a=!1,i.push(MSG_INVAL_PASSWORD)),a?(msgErrValHide("msg-alert-reg"),apiRegister(e.value,t.value,n.value)):msgErrVal("msg-alert-reg",i.join(", "))}function validateRegForm(){try{document.getElementById("btn-register").addEventListener("click",validateRegData)}catch(e){}}function apiEditUser(e){var t=_objectSpread({},e),n=new URLSearchParams(t).toString();API.patch("/users/edit/",n,{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){204===e.status?window.location.reload():e.json().then(function(e){msgErrVal("msg-alert-edit-user",e.body.error)})})}function validateEditProfileData(){var e=document.getElementById("inp-new-email"),t=document.getElementById("inp-new-pass"),n=document.getElementById("inp-file-avatar"),a=!0,i=[];if(valEmail(e.value)?validInput(e):(invalidInput(e),i.push(MSG_INVAL_EMAIL),a=!1),valPassword(t.value)?validInput(t):(invalidInput(t),i.push(MSG_INVAL_PASSWORD),a=!1),n.files[0]&&(valFile(n.files[0].name)?validInput(n):(invalidInput(n),i.push(MSG_INVAL_FILE),a=!1)),a){var d=!1;msgErrValHide("msg-alert-edit-user");var l={};e.getAttribute("data-origin-val")!==e.value&&(l.email=e.value,d=!0),t.getAttribute("data-origin-val")!==t.value&&(l.password=t.value,d=!0),d?apiEditProfile(l):msgErrVal("msg-alert-edit-user","No data modified.")}else msgErrVal("msg-alert-edit-user",i.join(", "))}function validateEditUserForm(){try{document.getElementById("btn-edit-user").addEventListener("click",validateEditUserData)}catch(e){}}window.addEventListener("load",validateAddEmailForm),window.addEventListener("load",pagAddEmailForm),window.addEventListener("load",validateRemoveEmailForms),window.addEventListener("load",validateAddFriendsForm),window.addEventListener("load",validatePlayForm),window.addEventListener("load",validateLoginForm),window.addEventListener("load",leaveSession),window.addEventListener("load",validateEditProfileForm),window.addEventListener("load",validateAddQuestionForm),window.addEventListener("load",validateRegForm),window.addEventListener("load",validateEditUserForm);